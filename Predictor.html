<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TNEA 2025 College Predictor - Tool</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    form { max-width: 600px; margin-bottom: 20px; }
    form label { display: block; margin: 10px 0; }
    form input, form select { width: 100%; padding: 8px; box-sizing: border-box; }
    form button { padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
    form button:hover { background: #0056b3; }
    #results div { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>TNEA 2025 College Predictor</h1>
  <form id="tnea-form">
    <label>Community (e.g., OC, BC): <input id="community" type="text" required></label>
    <label>Community Rank (0â€“200): <input id="community-rank" type="number" step="0.1" min="0" max="200" required></label>
    <label>Govt School Community Rank: <input id="govt-community-rank" type="number" step="0.1" min="0" max="200"></label>
    <label>Overall Rank: <input id="overall-rank" type="number" min="1" required></label>
    <label>Govt School Rank: <input id="govt-rank" type="number" min="1"></label>
    <label>Preferred District: 
      <select id="district">
        <option value="">Any</option>
        <option value="Ariyalur">Ariyalur</option>
        <option value="Chennai">Chennai</option>
        <option value="Coimbatore">Coimbatore</option>
        <option value="Cuddalore">Cuddalore</option>
        <option value="Dharmapuri">Dharmapuri</option>
        <option value="Dindigul">Dindigul</option>
        <option value="Erode">Erode</option>
        <option value="Kallakurichi">Kallakurichi</option>
        <option value="Kancheepuram">Kancheepuram</option>
        <option value="Karur">Karur</option>
        <option value="Krishnagiri">Krishnagiri</option>
        <option value="Madurai">Madurai</option>
        <option value="Mayiladuthurai">Mayiladuthurai</option>
        <option value="Nagapattinam">Nagapattinam</option>
        <option value="Namakkal">Namakkal</option>
        <option value="Nilgiris">Nilgiris</option>
        <option value="Perambalur">Perambalur</option>
        <option value="Pudukkottai">Pudukkottai</option>
        <option value="Ramanathapuram">Ramanathapuram</option>
        <option value="Ranipet">Ranipet</option>
        <option value="Salem">Salem</option>
        <option value="Sivagangai">Sivagangai</option>
        <option value="Tenkasi">Tenkasi</option>
        <option value="Thanjavur">Thanjavur</option>
        <option value="Theni">Theni</option>
        <option value="Thoothukudi">Thoothukudi</option>
        <option value="Tiruchirappalli">Tiruchirappalli</option>
        <option value="Tirunelveli">Tirunelveli</option>
        <option value="Tirupathur">Tirupathur</option>
        <option value="Tiruppur">Tiruppur</option>
        <option value="Tiruvallur">Tiruvallur</option>
        <option value="Tiruvannamalai">Tiruvannamalai</option>
        <option value="Tiruvarur">Tiruvarur</option>
        <option value="Vellore">Vellore</option>
        <option value="Viluppuram">Viluppuram</option>
        <option value="Virudhunagar">Virudhunagar</option>
        <option value="Chengalpattu">Chengalpattu</option>
        <option value="Kanyakumari">Kanyakumari</option>
      </select>
    </label>
    <label>Preferred Course: 
      <select id="course">
        <option value="CS">Computer Science</option>
        <option value="EC">Electronics and Communication</option>
        <option value="ME">Mechanical</option>
        <option value="EE">Electrical and Electronics</option>
        <option value="IT">Information Technology</option>
        <option value="CE">Civil</option>
        <option value="BT">Biotechnology</option>
      </select>
    </label>
    <label><input id="is-govt-school" type="checkbox"> Government School Student (7.5% Quota)</label>
    <button type="submit">Predict Colleges</button>
  </form>
  <div id="results"></div>
  <script>
    async function loadColleges() {
      try {
        const response = await fetch('colleges.json');
        if (!response.ok) throw new Error('Failed to load colleges.json');
        return await response.json();
      } catch (error) {
        console.error(error);
        document.getElementById('results').innerHTML = '<p>Error loading college data. Please try again later.</p>';
        return [];
      }
    }

    function predictColleges(inputs) {
      const { communityRank, govtSchoolCommunityRank, overallRank, govtSchoolRank, preferredDistrict, preferredCourse, isGovtSchool, community } = inputs;
      loadColleges().then(colleges => {
        const filteredColleges = colleges.filter(college => {
          if (preferredDistrict && college.district.toLowerCase() !== preferredDistrict.toLowerCase()) return false;
          if (!college.branches.some(branch => branch.code === preferredCourse)) return false;

          if (isGovtSchool && college.is_7.5_quota_eligible) {
            const cutoff = college.cutoff_2025[preferredCourse]?.["7.5_quota"];
            return cutoff && (govtSchoolCommunityRank <= cutoff || govtSchoolRank <= cutoff);
          }

          const cutoff = college.cutoff_2025[preferredCourse]?.[community?.toUpperCase() || "OC"];
          return cutoff && (communityRank <= cutoff || overallRank <= cutoff);
        });

        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = filteredColleges.length ? filteredColleges.map(college => `
          <div>
            <h3>${college.institute_name}</h3>
            <p>TNEA Code: ${college.tnea_code}</p>
            <p>Address: ${college.address}</p>
            <p>District: ${college.district}</p>
            <p>Website: <a href="${college.website}" target="_blank">${college.website}</a></p>
            <p>Branch: ${college.branches.find(b => b.code === preferredCourse)?.name || preferredCourse}</p>
            <p>Cut-Off (2025): ${isGovtSchool ? college.cutoff_2025[preferredCourse]["7.5_quota"] : college.cutoff_2025[preferredCourse][community?.toUpperCase() || "OC"]}</p>
          </div>
        `).join('') : '<p>No colleges match your criteria. Try adjusting your inputs.</p>';
      });
    }

    document.getElementById('tnea-form').addEventListener('submit', e => {
      e.preventDefault();
      const inputs = {
        community: document.getElementById('community').value,
        communityRank: parseFloat(document.getElementById('community-rank').value),
        govtSchoolCommunityRank: parseFloat(document.getElementById('govt-community-rank').value) || 0,
        overallRank: parseFloat(document.getElementById('overall-rank').value),
        govtSchoolRank: parseFloat(document.getElementById('govt-rank').value) || 0,
        preferredDistrict: document.getElementById('district').value,
        preferredCourse: document.getElementById('course').value,
        isGovtSchool: document.getElementById('is-govt-school').checked
      };
      predictColleges(inputs);
    });
  </script>
</body>
</html>
